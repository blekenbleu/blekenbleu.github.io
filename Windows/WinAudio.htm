<html><head>
<link rel='stylesheet' type='text/css' href='../../static/my.css'>

<style>
table.ct th, td { text-align:center; }
</style>

<title>Windows Sound</title>
</head>

<body>
<div align=center>
<table class="my_table"><tr><td style="text-align:left">

<h2>Windows Sound</h2>
<font size=+1>
<p><i>Before installing VB-Audio's
</i><a href=#VM><b>VoiceMeeter Banana</b></a>,<br>
 <code>Somnium Space</code> <i>worked with</i> <code>VB-Audio CABLE</code>, then quit  because of<br>
misconfiguration prompted by problematic Windows sound terminolgy.</p>

<h4><a href=../pedals/WindowsAudio.htm>Windows audio basics</a></h4><br>

<details><summary><b>Windows Audio Latency</b></summary><ul>
<li><a href="https://www.thewindowsclub.com/sound-delays-lags-and-audio-latency-in-windows-10">REal or REduce Audio Latency</a> on <a href="https://github.com/miniant-git/REAL">GitHub</a>
<li><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/audio/low-latency-audio">Low Latency Audio:&nbsp <b>AudioGraph API</b></a>
<li><a href="https://windowsreport.com/audio-lagging/">Replace Realtek driver with generic Windows driver</a><br>
 &nbsp &nbsp (<i>High Definition Audio Device</i>)<br>
 &nbsp &nbsp <a href="https://discuss.cakewalk.com/index.php?/topic/40595-cakewalkrealtekasio-and-windows-11-%F0%9F%99%84/">use WASAPI Exclusive for sub 5ms latency</a>
<li><a href="https://www.sweetwater.com/sweetcare/articles/roland-difference-between-asio-wdm-mme-drivers/">ASIO (better overall)
	 vs MME (old, poor) vs WDM(KS)<br> vs WASAPI(not as low as ASIO)</a>
<li><a href="https://gearspace.com/board/music-computers/1376608-asio-still-necessary-low-latency.html"><b>WASAPI</b></a> <b>Exclusive</b>:&nbsp but only one app;<br>
 &nbsp &nbsp <b>Low Latency Mode (aka AudioGraph)</b>:&nbsp only with certain devices
<li><a href="https://www.baumannmusic.com/2021/the-official-asio-driver-for-realtek-hd-audio-dell-hp-lenovo-asus/">official RealTek add-on ASIO driver</a> on <a href="https://www.dell.com/support/home/de-de/drivers/driversdetails?driverid=7776f">Dell website</a><br>
<li><a href="https://www.resplendence.com/latencymon"><b>LatencyMon</b></a><br>
<li><a href="https://forum.vb-audio.com/viewtopic.php?t=1204">VB ASIO driver tester</a><br>
<li><a href="https://oblique-audio.com/rtl-utility.php">RTL UTILITY - Round Trip Latency</a><br>
</details>

<h3>Windows 11 sound routing</h3>
<h4>Windows default input</h4>
Windows sound output does not play default input,<br> but e.g. <a href=#VM><b>VoiceMeeter</b></a> can route specific devices.<br><br>

Except for defaults, Windows 11 configures sound devices<br> for
<a href="https://answers.microsoft.com/en-us/windows/forum/all/what-is-exclusive-mode-and-what-does-it-do/26922597-f6c8-4080-a675-199e37f37a0b">exclusive access</a>,
potentially reducing latency.<br>
Windows Sound Control Panels and Settings can also,
<br><i>but fails to warn</i>
when multiple programs are misconfigured<br>
to use some device with exclusive access set.<br><br>

<a href=#VM>VoiceMeeter</a> can split non-default input (e.g. <a href=#TTS>Text to Speech</a>)<br>
to feed both e.g.
<a href="../XR/VR1.html#space">Somnium Space VR</a> and default sound.<br><br>

To assign Windows Sound devices as defaults or to/from select apps:<br>
<b>System > Sound > Volume mixer</b><br> &nbsp (From <b>System > Sound</b>, scroll down to select "Volume mixer".)<br>
<code>v</code> to the right of each App exposes Output and Input device selections.<br><br>

<details><summary><b>Text to Speech Voice Reader</b> <a href="https://apps.microsoft.com/detail/text-to-speech-voice-reader/9NGSXZ0ZTH1G?hl=en-US&gl=US"><b>from Microsoft Store</b></a></summary>
<a name=TTS>works with <code>Somnium Space</code></a><br>
via <a href="https://vb-audio.com/Cable/"><code>CABLE (VB-Audio Virtual Cable)</code></a>:
<br><div align=center><img src=image/Properties.jpg></div><br>
...but <code>Somnium Space</code> did not detect <a href=#VM>VoiceMeeter</a> Output<br>
<code>(VB-Audio VoiceMeeter VAIO)</code> virtual device.<br>


In twisted M$ minds, "<code>Don't Allow</code>" means<br> that <i>this device is currently allowed</i>.<br>
  Pressing "<code>Don't Allow</code>" <i>here</i> is equivalent to (right click) <b>Disable</b><br>
 in Sound control panel <code>Playback</code> or <code>Recording</code>, so baffling redundancy...<br>
"Allow applications to take exclusive control of this device" is still available<br>
 in Sound control panel device <code>Properties &gt; Advanced</code>.<br>
Connecting Somnium Space exclusively to <code>VB-Audio CABLE Out</code><br>
 no longer seems to work, but Somnium Space 2D hangs...

<h4>Test script for <a href=#TTS>Text to Speech Voice Reader</a></h4>
"<code>. .</code>" between lines reduces voicing previous word when playing a line...
<pre>
. Hello.
. .
This is voiced from text, and I text poorly.
. .
I am uncertain what is actually heard in Somnium Space.
. .
I would say something interesting here, but not yet.
. .
I am not particularly artificial, just lacking personality.
. .
testing 1 2 3.
. .
Is this too loud or quiet?
. .
I cannot multi-task.
. .
I text poorly.
. .
line 9.
. .
still sorting text to audio.
. .
I suppose that all intelligence is artificial.
. .
Thanks.
..
</pre>
<hr>
<a name=#TTS><b>Text to Speech Voice Reader</b></a> stalls and hangs<br>
 if connected to a disabled sound input;&nbsp
ask me how I know...</details><br>


<details><summary><b>VB-Audio <a href="https://vb-audio.com/Voicemeeter/banana.htm">VoiceMeeter Banana</a></b></summary>
<a name=VM>&nbsp</a>
<a href=Voicemeeter.htm><i>reinstallation - 17 May 2025</i></a>
<br>VoiceMeeter routes sound among apps and devices,<br>
 providing virtual devices to which apps can connect.<br>
Its <a href="https://voicemeeter.com/user-guide-connect-audio-apps-to-the-voicemeeter-insert-driver/">ASIO Insert</a> enables adjusting <a href=../SimHub/>SimHub</a> tactile audio signals via <a href=../MIDI/>MIDI</a>.<br>

<a href="https://discord.com/invite/mBvWzeF3a8"><i>VoiceMeeter discord</i></a><br>
<a href="https://www.youtube.com/watch?v=YxWE-enkOhY"><i>VoiceMeeter Potato adds filtering per channel</i></a><br>

<h4><a href="https://www.racedepartment.com/threads/simhub-plugin-s-for-output-to-midi-and-vjoy.210079/#post-3446537:>VoiceMeeter Banana configuration</a></h4>

<h4><a href="https://www.youtube.com/watch?v=pEd7jw0uNE4&t=91s">VoiceMeeter setup video by TheFranswah Studio video"</a></h4>
Making VoiceMeeter the default audio devices.<br>
Official <a href="https://voicemeeter.com/setup-voicemeeter-with-windows-11-disable-mic-privacy/">VoiceMeeter in Windows 11</a><br>

<h4>VoiceMeeter patches</h4>
Reconfigured VoiceMeeter VAIO as default Windows sound output device<br>
and VB-Audio Cable as Windows sound default input.<br>
<table class="ct" border=1 width=500>
<tr> <th>source /<br>destination</th> <th>input</th> <th>CABLE In<br>default In</th>
	 <th>CABLE Out</th> <th>A1<br>X-Fi</th> <th>A2<br>Denon</th>
	 <th>A3<br>RealTek</th> <th>B1<br>Somnium</th> <th>B2</th></tr>
<tr> <td>Text to Speech</td> <td>Cable In</td> <td>x</td> <td></td>
	 <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
<tr> <td>Cable Out</td> <td>INPUT 1</td> <td></td> <td>x</td>
	 <td>x</td> <td>x</td> <td></td> <td>x</td> <td></td> </tr>
<tr> <td></td> <td>INPUT 2</td> <td></td> <td></td> <td></td>
	 <td></td> <td></td> <td></td> <td></td> </tr>
<tr> <td></td> <td>INPUT 3</td> <td></td> <td></td> <td></td>
	 <td></td> <td></td> <td></td> <td></td> </tr>
<tr> <td>default output</td> <td>VAIO</td> <td></td> <td></td>
	 <td>x</td> <td>x</td> <td></td> <td></td> <td></td> </tr>
<tr> <td><a href=#SH>SimHub<br>ShakeIt</a></td> <td>AUX</td> <td></td> <td></td> <td></td>
	 <td></td> <td>x</td> <td></td> <td></td> </tr>
</table><dl>
<dt>Translated:
Text to Speech outputs to VB-Cable (default input),
<dd>used e.g. by Somnium via B1 virtual device,
<dd>but also passed to X-Fi for headphones and Denon for surround.
<dt>VAIO is Windows default output, also passed to X-Fi and Denon (but not Somnium).
<dt>SimHub tactile goes to AUX, which gets routed to RealTek motherboard audio

<dt><b>Exclusive mode disabled for VoiceMeeter VAIO Input</b>
<dd><ul><li> because Default Playback Device
<li>X-Fi volume control is no longer effective...
<li>Windows volume slider is bypassed;&nbsp  <a href="https://voicemeeter.com/volume-control-how-to-change-the-volume-of-your-main-output-without-the-mouse/">VoiceMeeter volume control HowTo</a>
<li>VB-Audio CABLE patched to VoiceMeeter Input 1 for a third Playback device</ul></dl>
<details><summary>click for images</summary>
<img src=image/VB-Audio.jpg><br><br>
<img src=image/hook.jpg><br><br>
<table><tr><td>
VB-Audio manages to have its CABLE input labelled Output;<br>
Somnium is the only app needing non-default device:</td><td>
 Similarly VB-Audio outputs are labelled Inputs:</td></tr><tr><td>
<img src=image/mixer.jpg></td><td style="vertical-align: top;">
<img src=image/Sound.png></td></tr></table>
</details></details><br>

<details><summary><b>tactile signal manipulation</b> for <a href=../../static/SimHub/HowTo.htm#HowTo><b>SimHub ShakeIt</b></a></summary>
<a name=SH>ShakeIt</a> tactile effect audio signal amplitudes<br>
 for e.g. clutch and loaded wheel slip telemetry<br>
 can be modulated by <a href="https://github.com/blekenbleu/MIDIio">MIDIio</a> <i>outside SimHub</i>.<br>
Possiblities;<ul>
<li>MIDI-aware multichannel fader app reading tactile audio from a virtual cable<br> and writing to an amplifier sound card.<br>
<li>MIDI-aware <a href=VSThost.htm><b>VST host</b></a> and multichannel fader plugin for
<A HREF="https://voicemeeter.com/user-guide-connect-audio-apps-to-the-voicemeeter-insert-driver/">VoiceMeeter ASIO Insert</a><br>
 &nbsp Among thousands of VST plugins, few implement multichannel faders.<br>

<details><summary>Known VST multichannel fader plugins</summary><a name=faders><ul></a>

<li><a href="https://www.matthiaskronlachner.com/?p=1910"><b>mcfx multichannel audio 64-bit plug-in suite</b></a>
 	&nbsp <a href="https://github.com/kronihias/mcfx">on GitHub</a><br><img src=image/mcfx_gain_delay8.png><ul>
	<li>Works with VoxYou, VSTHost and Element, but only +/-18db fader range
	<li>Only VoxYou renders its full UI
	<li>C++ source seems not too daunting;  gain limits line 362 of PluginEditor.cpp</ul>
 <details><summary>installation details</summary><pre>
Output folder: C:\Program Files\Steinberg\VSTPlugins
Extract: mcfx_convolver16.dll... 100%
Extract: mcfx_convolver2.dll... 100%
Extract: mcfx_convolver24.dll... 100%
Extract: mcfx_convolver32.dll... 100%
Extract: mcfx_convolver36.dll... 100%
Extract: mcfx_convolver4.dll... 100%
Extract: mcfx_convolver50.dll... 100%
Extract: mcfx_convolver64.dll... 100%
Extract: mcfx_convolver8.dll... 100%
Extract: mcfx_delay16.dll... 100%
Extract: mcfx_delay2.dll... 100%
Extract: mcfx_delay24.dll... 100%
Extract: mcfx_delay32.dll... 100%
Extract: mcfx_delay36.dll... 100%
Extract: mcfx_delay4.dll... 100%
Extract: mcfx_delay50.dll... 100%
Extract: mcfx_delay64.dll... 100%
Extract: mcfx_delay8.dll... 100%
Extract: mcfx_filter16.dll... 100%
Extract: mcfx_filter2.dll... 100%
Extract: mcfx_filter24.dll... 100%
Extract: mcfx_filter32.dll... 100%
Extract: mcfx_filter36.dll... 100%
Extract: mcfx_filter4.dll... 100%
Extract: mcfx_filter50.dll... 100%
Extract: mcfx_filter64.dll... 100%
Extract: mcfx_filter8.dll... 100%
Extract: mcfx_gain_delay16.dll... 100%
Extract: mcfx_gain_delay2.dll... 100%
Extract: mcfx_gain_delay24.dll... 100%
Extract: mcfx_gain_delay32.dll... 100%
Extract: mcfx_gain_delay36.dll... 100%
Extract: mcfx_gain_delay4.dll... 100%
Extract: mcfx_gain_delay50.dll... 100%
Extract: mcfx_gain_delay64.dll... 100%
Extract: mcfx_gain_delay8.dll... 100%
Extract: mcfx_meter16.dll... 100%
Extract: mcfx_meter2.dll... 100%
Extract: mcfx_meter24.dll... 100%
Extract: mcfx_meter32.dll... 100%
Extract: mcfx_meter36.dll... 100%
Extract: mcfx_meter4.dll... 100%
Extract: mcfx_meter50.dll... 100%
Extract: mcfx_meter64.dll... 100%
Extract: mcfx_meter8.dll... 100%
Output folder: C:\Program Files\Steinberg\VSTPlugins
Output folder: C:\WINDOWS\system32
Extract: libfftw3f-3.dll... 100%
Completed
</pre>
</details><br>

<li><a href="https://www.kvraudio.com/product/vstmixer-by-mirax-labs">Mirax Labs vstMixer</a><br>
<img src=image/vstMixer.png><br>Loaded by neither VoxYou nor Element;&nbsp tiny panels patch inputs to output faders.<br><br>

<li><a href="https://www.audioworld.de/AudioWorld%20VST-Plugins.php">SonicAlarm_multi-channel_level_trimmer</a><br>
	<img src=image/SonicAxiom_multi-channel_level_trimmer_8x_mono.png><br>
	Only +/-20 range<br><br>
</ul>
</details>
</ul>

<details><summary><b>DIY fader plugin?</b></summary><ul>
<li><a href="https://github.com/mikeoliphant/AudioPlugSharp">AudioPlugSharp - Easily create VST3 audio plugins in C#</a>
<li><a href="https://www.nuget.org/packages/PortAudioSharp2">PortAudioSharp2 C# binding</a>
<li><a href="https://github.com/Kyle-Gagner/PortAudio.Net/tree/master">PortAudio.Net</a> &nbsp
	<a href="https://files.portaudio.com/docs/v19-doxydocs/api_overview.html">API overview</a> &nbsp
	<a href="https://github.com/PortAudio/portaudio/wiki">Wiki</a>
<li><a href="https://github.com/obiwanjacobi/vst.net">VST.NET 2</a><br>
	<a href="https://obiwanjacobi.github.io/vst.net/GettingStarted.html">Getting Started</a>
<li><a href="https://docs.juce.com/master/tutorial_create_projucer_basic_plugin.html">JUCE tutorial: Create a basic Audio/MIDI plugin</a>
<li><a href="https://github.com/markheath/naudio-asio-patchbay">low-level routing of audio using ASIO in NAudio</a>
<li><a href="https://github.com/LAGonauta/ASIORecAndPlay">route multichannel audio from one ASIO interface to another</a>


<li><a href="https://www.boost.org/doc/libs/1_83_0/doc/html/boost_asio/overview/signals.html">Boost.Asio signal handling</a>
<li><a href="https://www.tobias-erichsen.de/software.html">loopMIDI</a>
<li><a href="https://vb-audio.com/Voicemeeter/VoicemeeterBanana_UserManual.pdf">VoiceMeeter Remote API</a> with audio callbacks (pg 57/74)<br>
	<a href="https://forum.vb-audio.com/viewtopic.php?f=8&t=346">general info</a> &nbsp
	<a href="https://github.com/vburel2018/Voicemeeter-SDK">GitHub SDK</a><br>
</ul>
</details>
</details>

<br><li><b>VST</b> <a href=VSThost.htm>hosts</a> &nbsp <a href=steinberg/>VST3 plugins</a>

</td></tr><tr><td align=center>
maintained by <a href="https://github.com/blekenbleu">blekenbleu</a><br>
</td></tr></table></div>

</body></html>

