<html><head>
<link rel='stylesheet' type='text/css' href='../../static/my.css'>

<style>
table.ct th, td { text-align:center; }
</style>

<title>Windows Sound</title>
</head>

<body>
<div align=center>
<table class="my_table"><tr><td style="text-align:left">

<h2>Windows Sound</h2>
<font size=+1>
<p><i>Before installing VB-Audio's
</i><a href=#VM><code>Voicemeeter Banana</code></a>,<br>
 <code>Somnium Space</code> <i>worked with their</i>
<code>VB-Audio CABLE</code>.<br>
It quit because of Windows sound terminolgy<br> and problematic configuration.</p>

<h4><a href=../pedals/WindowsAudio.htm>Windows audio basics</a></h4><br>

<details><summary><b>Windows Audio Latency</b></summary><ul>
<li><a href="https://www.thewindowsclub.com/sound-delays-lags-and-audio-latency-in-windows-10">REal or REduce Audio Latency</a> on <a href="https://github.com/miniant-git/REAL">GitHub</a>
<li><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/audio/low-latency-audio">Low Latency Audio:&nbsp <b>AudioGraph API</b></a>
<li><a href="https://windowsreport.com/audio-lagging/">Replace Realtek driver with generic Windows driver</a><br>
 &nbsp &nbsp (<i>High Definition Audio Device</i>)<br>
 &nbsp &nbsp <a href="https://discuss.cakewalk.com/index.php?/topic/40595-cakewalkrealtekasio-and-windows-11-%F0%9F%99%84/">use WASAPI Exclusive for sub 5ms latency</a>
<li><a href="https://www.sweetwater.com/sweetcare/articles/roland-difference-between-asio-wdm-mme-drivers/">ASIO (better overall)
	 vs MME (old, poor) vs WDM(KS)<br> vs WASAPI(not as low as ASIO)</a>
<li><a href="https://gearspace.com/board/music-computers/1376608-asio-still-necessary-low-latency.html"><b>WASAPI</b></a> <b>Exclusive</b>:&nbsp but only one app;<br>
 &nbsp &nbsp <b>Low Latency Mode (aka AudioGraph)</b>:&nbsp only with certain devices
<li><a href="https://www.baumannmusic.com/2021/the-official-asio-driver-for-realtek-hd-audio-dell-hp-lenovo-asus/">official RealTek add-on ASIO driver</a> on <a href="https://www.dell.com/support/home/de-de/drivers/driversdetails?driverid=7776f">Dell website</a><br>
<li><a href="https://www.resplendence.com/latencymon"><b>LatencyMon</b></a><br>
<li><a href="https://forum.vb-audio.com/viewtopic.php?t=1204">VB ASIO driver tester</a><br>
<li><a href="https://oblique-audio.com/rtl-utility.php">RTL UTILITY - Round Trip Latency</a><br>
</details>

<h3>Windows 11 sound routing</h3>
<h4>Windows default input</h4>
Windows sound output does not play default input,<br> but e.g. Voicemeeter can route specific devices.<br><br>

Except for defaults, Windows 11 configures sound devices<br> for
<a href="https://answers.microsoft.com/en-us/windows/forum/all/what-is-exclusive-mode-and-what-does-it-do/26922597-f6c8-4080-a675-199e37f37a0b">exclusive access</a>,
potentially reducing latency.<br>
Windows settings could, <i>but fails to</i> warn<br>
when multiple programs are misconfigured<br>
to use the same device having exclusive access set.<br>
Consequently, any not-default input (e.g. <a href=#TTS>Text to Speech</a>) output<br>
must be somehow split to feed both e.g.
<a href="../XR/VR1.html#space">Somnium Space VR</a> and default sound.<br>
<b>System > Sound > Sound Mixer</b>,<br> where Sound Mixer requires scrolling nearly to the bottom of <b>System > Sound</b>.<br>
The <code>v</code> to the right of each App exposes Output and Input device selection.<br><br>

<details><summary><b>Text to Speech Voice Reader</b> <a href="https://apps.microsoft.com/detail/text-to-speech-voice-reader/9NGSXZ0ZTH1G?hl=en-US&gl=US"><b>from Microsoft Store</b></a></summary>
<a name=TTS>works with <code>Somnium Space</code></a><br>
via <a href="https://vb-audio.com/Cable/"><code>CABLE (VB-Audio Virtual Cable)</code></a>:
<br><div align=center><img src=image/Properties.jpg></div><br>
...but <code>Somnium Space</code> did not detect <a href=#VM>VoiceMeeter</a> Output<br>
<code>(VB-Audio VoiceMeeter VAIO)</code> virtual device.<br>


In twisted M$ minds, "<code>Don't Allow</code>" means<br> that <i>this device is currently allowed</i>.<br>
  Pressing "<code>Don't Allow</code>" <i>here</i> is equivalent to (right click) <b>Disable</b><br>
 in Sound control panel <code>Playback</code> or <code>Recording</code>, so baffling redundancy...<br>
"Allow applications to take exclusive control of this device" is still available<br>
 in Sound control panel device <code>Properties &gt; Advanced</code>.<br>
Connecting Somnium Space exclusively to <code>VB-Audio CABLE Out</code><br>
 no longer seems to work, but Somnium Space 2D hangs...

<h4>Test script for <a href=#TTS>Text to Speech Voice Reader</a></h4>
"<code>. .</code>" between lines reduces voicing previous word when playing a line...
<pre>
. Hello.
. .
This is voiced from text, and I text poorly.
. .
I am uncertain what is actually heard in Somnium Space.
. .
I would say something interesting here, but not yet.
. .
I am not particularly artificial, just lacking personality.
. .
testing 1 2 3.
. .
Is this too loud or quiet?
. .
I cannot multi-task.
. .
I text poorly.
. .
line 9.
. .
still sorting text to audio.
. .
I suppose that all intelligence is artificial.
. .
Thanks.
..
</pre>
<hr>
<a name=#TTS><b>Text to Speech Voice Reader</b></a> stalls and hangs<br>
 if connected to a disabled sound input;&nbsp
ask me how I know...</details><br>

<details><summary><b>VB-Audio <a href="https://vb-audio.com/Voicemeeter/banana.htm">VoiceMeeter Banana</a></b></summary>
<a name=VM>&nbsp</a>

<a href="https://discord.com/invite/mBvWzeF3a8"><i>VoiceMeeter discord</i></a><br>
<a href="https://www.youtube.com/watch?v=YxWE-enkOhY"><i>VoiceMeeter Potato adds filtering per channel</i></a><br>

<h4><a href="https://www.racedepartment.com/threads/simhub-plugin-s-for-output-to-midi-and-vjoy.210079/#post-3446537:>VoiceMeeter Banana configuration</a></h4>

<h4><a href="https://www.youtube.com/watch?v=pEd7jw0uNE4&t=91s">VoiceMeeter setup video by TheFranswah Studio video"</a></h4>
Making VoiceMeeter the default audio devices.<br>
Official <a href="https://voicemeeter.com/setup-voicemeeter-with-windows-11-disable-mic-privacy/">VoiceMeeter in Windows 11</a><br>

<h4>VoiceMeeter patches</h4>
Reconfigured VoiceMeeter VAIO as default Windows sound output device<br>
and VB-Audio Cable as Windows sound default input.<br>
<table class="ct" border=1 width=500>
<tr> <th>source /<br>destination</th> <th>input</th> <th>CABLE In<br>default In</th>
	 <th>CABLE Out</th> <th>A1<br>X-Fi</th> <th>A2<br>Denon</th>
	 <th>A3<br>RealTek</th> <th>B1<br>Somnium</th> <th>B2</th></tr>
<tr> <td>Text to Speech</td> <td>Cable In</td> <td>x</td> <td></td>
	 <td></td> <td></td> <td></td> <td></td> <td></td> </tr>
<tr> <td>Cable Out</td> <td>INPUT 1</td> <td></td> <td>x</td>
	 <td>x</td> <td>x</td> <td></td> <td>x</td> <td></td> </tr>
<tr> <td></td> <td>INPUT 2</td> <td></td> <td></td> <td></td>
	 <td></td> <td></td> <td></td> <td></td> </tr>
<tr> <td></td> <td>INPUT 3</td> <td></td> <td></td> <td></td>
	 <td></td> <td></td> <td></td> <td></td> </tr>
<tr> <td>default output</td> <td>VAIO</td> <td></td> <td></td>
	 <td>x</td> <td>x</td> <td></td> <td></td> <td></td> </tr>
<tr> <td><a href=#SH>SimHub<br>ShakeIt</a></td> <td>AUX</td> <td></td> <td></td> <td></td>
	 <td></td> <td>x</td> <td></td> <td></td> </tr>
</table><dl>
<dt>Translated:
Text to Speech outputs to VB-Cable (default input),
<dd>used e.g. by Somnium via B1 virtual device,
<dd>but also passed to X-Fi for headphones and Denon for surround.
<dt>VAIO is Windows default output, also passed to X-Fi and Denon (but not Somnium).
<dt>SimHub tactile goes to AUX, which gets routed to RealTek motherboard audio

<dt><b>Exclusive mode disabled for VoiceMeeter VAIO Input</b>
<dd><ul><li> because Default Playback Device
<li>X-Fi volume control is no longer effective...
<li>Windows volume slider is bypassed;&nbsp  <a href="https://voicemeeter.com/volume-control-how-to-change-the-volume-of-your-main-output-without-the-mouse/">VoiceMeeter volume control HowTo</a>
<li>VB-Audio CABLE patched to VoiceMeeter Input 1 for a third Playback device</ul></dl>
<details><summary>click for images</summary>
<img src=image/VB-Audio.jpg><br><br>
<img src=image/hook.jpg><br><br>
<table><tr><td>
VB-Audio manages to have its CABLE input labelled Output;<br>
Somnium is the only app needing non-default device:</td><td>
 Similarly VB-Audio outputs are labelled Inputs:</td></tr><tr><td>
<img src=image/mixer.jpg></td><td style="vertical-align: top;">
<img src=image/Sound.png></td></tr></table>
</details></details><br>

<details><summary><b>tactile signal manipulation for <a href=../../static/SimHub/HowTo.htm#HowTo>SimHub ShakeIt</a></b></summary>
<a name=SH>ShakeIt</a> tactile effect audio signal amplitudes<br>
 for e.g. clutch and loaded wheel slip telemetry<br>
 can be modulated by <a href="https://github.com/blekenbleu/blekenbleu.MIDIio">MIDIio</a> <i>outside SimHub</i>.<br>
Possiblities;<ul>
<li>a MIDI-aware fader app reading audio from a multichannel virtual cable<br> and writing to tactile amplifier sound card.<br>
<li><details><summary>MIDI-aware VST host and multichannel fader VST with
<A HREF="https://voicemeeter.com/user-guide-connect-audio-apps-to-the-voicemeeter-insert-driver/">VoiceMeeter ASIO Insert</a></summary>
Seemingly few VST hosts hosts implement easy MIDI configuration.<br>
Beyond that, few support all VST plugins flavors (VST or VST3, 32- or 64-bit).<br>
VST hosts mentioned in <a href="https://forum.vb-audio.com/search.php?keywords=vst+host">VB-Audio's Forums</a>:<br>
<a href="https://www.cantabilesoftware.com/free-vst-host">Cantabile Lite</a>,
 <a href="https://github.com/falkTX/Carla">Carla</a>, <a href="https://github.com/kushview/element">Element</a>,
<a href="https://github.com/RainOrigami/VoxYou">VoxYou</a>, VSTHost
<ul>
<li><a href="https://technium.ch/voicemeeter-banana-setup-tutorial/">Voicemeeter Banana Setup - Tutorial with VoxYou</a>
<li><a href="https://unison.audio/vst-host/">The 7 Most Impressive Free VST Hosts Of 2023</a>
<li><a href="https://github.com/obiwanjacobi/vst.net/issues/10">VST Host 32/64 bit mixed plugin support - VST.NET</a>
<li><a href="https://hackaday.io/project/160858-vstibox/log/152480-c-vst-host-daw">C# VST host</a>
<li><a href="https://hackaday.io/project/160858-vstibox">VSTiBox is a synthesizer for hosting VST software synths</a>
<li><a href="https://teragonaudio.com/article/How-to-make-your-own-VST-host.html">How to make your own VST host</a>
<li><a href="https://www.hermannseib.com/english/vsthost.htm"><b>VSTHost</b></a><br>
&nbsp <a href="https://forum.hermannseib.com/viewtopic.php?t=32">https://forum.hermannseib.com/viewtopic.php?t=32</a><br>
&nbsp <a href="https://forum.hermannseib.com/viewtopic.php?t=26">VSTHost Registry Entries</a>
<li><a href="https://github.com/perivar/AudioVSTToolbox">AudioVSTToolbox with MidiHost example</a>
</ul></details>
While there are thousands of VST plugins, few implement multichannel faders.<br>
<li><a href="https://github.com/mikeoliphant/AudioPlugSharp">AudioPlugSharp - Easily create VST3 audio plugins in C#</a>
<li><a href="https://www.nuget.org/packages/PortAudioSharp2">PortAudioSharp2 C# binding</a>
<li><a href="https://github.com/Kyle-Gagner/PortAudio.Net/tree/master">PortAudio.Net</a> &nbsp
	<a href="https://files.portaudio.com/docs/v19-doxydocs/api_overview.html">API overview</a> &nbsp
	<a href="https://github.com/PortAudio/portaudio/wiki">Wiki</a>
<li><a href="https://github.com/obiwanjacobi/vst.net">VST.NET 2</a><br>
	<a href="https://obiwanjacobi.github.io/vst.net/GettingStarted.html">Getting Started</a>
<li><a href="https://docs.juce.com/master/tutorial_create_projucer_basic_plugin.html">JUCE tutorial: Create a basic Audio/MIDI plugin</a>
<li><a href="https://github.com/markheath/naudio-asio-patchbay">low-level routing of audio using ASIO in NAudio</a>
<li><a href=https://github.com/LAGonauta/ASIORecAndPlay"">route multichannel audio from one ASIO interface to another</a>


<li><a href="https://www.boost.org/doc/libs/1_83_0/doc/html/boost_asio/overview/signals.html">Boost.Asio signal handling</a>
<li><a href="https://www.tobias-erichsen.de/software.html">loopMIDI</a>
<li><a href="https://vb-audio.com/Voicemeeter/VoicemeeterBanana_UserManual.pdf">Voicemeeter Remote API</a> with audio callbacks (pg 57/74)<br>
	<a href="https://forum.vb-audio.com/viewtopic.php?f=8&t=346">general info</a> &nbsp
	<a href="https://github.com/vburel2018/Voicemeeter-SDK">GitHub SDK</a><br>
<li><a href="https://www.matthiaskronlachner.com/?p=1910">mcfx multichannel audio plug-in suite</a>
 &nbsp <a href="https://github.com/kronihias/mcfx">on GitHub</a>
<li><a href="http://www.angelofarina.it/X-MCFX.htm">X-MCFX low latency VST2/VST3 plugin on WIN64</a><br>
	&nbsp <a href="https://github.com/JB-Luke/X-MCFX">x-mcfx-gain-delay latest JUCE on ebay</a>
</ul>
<pre>

</pre>
</details>
</td></tr><tr><td align=center>
maintained by <a href="https://github.com/blekenbleu">blekenbleu</a><br>
</td></tr></table></div>

</body></html>

